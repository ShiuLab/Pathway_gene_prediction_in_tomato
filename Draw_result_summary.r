### draw summary
library('vioplot')
setwd('D:\\Pathway_prediction\\20180831\\Non_overlapping\\Cross_validation')
dat <- read.table('Pathway_best_F1_naive_clustering_ML_CR.txt',head=T,sep='\t',stringsAsFactors=F)
dat1 <- read.table('F1_matrix_naive_median_validation.txt',head=T,row.names=1,sep='\t',stringsAsFactors=F)
dat1 <- rbind(dat1,colMeans(dat1))
dat2 <- read.table('F1_matrix_naive_max_validation.txt',head=T,row.names=1,sep='\t',stringsAsFactors=F)
dat2 <- rbind(dat2,colMeans(dat2))
pdf('Naive_prediction_CR.pdf',width=10,height=10)
par(mfrow=c(2,10))
m <- rbind(c(1,2,3,4,5,6,6,6,6,6),c(7,7,7,7,7,8,8,8,8,8))
layout(m)
vioplot(as.numeric(dat1[86,1:656]),ylim=c(0,0.3))
abline(h=median(dat$Background_F1_crossvalidation))
vioplot(as.numeric(dat2[86,1:656]),ylim=c(0,0.3))
vioplot(dat[,5],ylim=c(0,0.3))
vioplot(dat[,4],ylim=c(0,0.3))
vioplot(dat$Background_F1_crossvalidation,ylim=c(0,0.3))
median_best_overall = which(dat1[86,1:656]==max(dat1[86,1:656]))[1]
max_best_overall = which(dat2[86,1:656]==max(dat2[86,1:656]))[1]
median_com <- merge(cbind(rownames(dat1)[1:85],dat1[1:85,median_best_overall]),dat[,c(1,5)],by.x='V1',by.y='Pathway')
max_com <- merge(cbind(rownames(dat2)[1:85],dat2[1:85,max_best_overall]),dat[,c(1,4)],by.x='V1',by.y='Pathway')
plot(as.numeric(as.character(median_com[,2])),as.numeric(median_com[,3]),xlim=c(0,0.3),ylim=c(0,0.3),cex=2,xlab='Naive_median_overall',ylab='Naive_median_pathway_best')
abline(0,1)
plot(as.numeric(as.character(max_com[,2])),as.numeric(max_com[,3]),xlim=c(0,0.3),ylim=c(0,0.3),cex=2,xlab='Naive_max_overall',ylab='Naive_max_pathway_best')
abline(0,1)
all(rownames(dat1)==rownames(dat2))
plot(dat[,5],dat[,4],xlim=c(0,0.3),ylim=c(0,0.3),cex=2,xlab='Naive_median_pathway_best',ylab='Naive_max_pathway_best')
abline(0,1)
dev.off()

library('vioplot')
setwd('D:\\Pathway_prediction\\20180831\\Non_overlapping\\Cross_validation')
dat <- read.table('Pathway_best_F1_naive_clustering_ML_CR.txt',head=T,sep='\t',stringsAsFactors=F)
dat1 <- read.table('F1_matrix_pathway_CR_kmean_setA.txt',head=T,row.names=1,sep='\t',stringsAsFactors=F)
dat1 <- rbind(dat1,colMeans(dat1))
dat2 <- read.table('F1_matrix_pathway_CR_Affinity_setA.txt',head=T,row.names=1,sep='\t',stringsAsFactors=F)
dat2 <- rbind(dat2,colMeans(dat2))
all(rownames(dat1)==rownames(dat2))
setA <- cbind(dat1,dat2)
dat3 <- read.table('F1_matrix_pathway_CR_kmean.txt',head=T,row.names=1,sep='\t',stringsAsFactors=F)
dat3 <- rbind(dat3,colMeans(dat3))
dat4 <- read.table('F1_matrix_pathway_CR_Affinity.txt',head=T,row.names=1,sep='\t',stringsAsFactors=F)
dat4 <- rbind(dat4,colMeans(dat4))
all(rownames(dat3)==rownames(dat4))
setB <- cbind(dat3,dat4)
kmean_setA = which(dat1[86,1:ncol(dat1)]==max(dat1[86,1:ncol(dat1)]))[1]
affinity_setA = which(dat2[86,1:ncol(dat2)]==max(dat2[86,1:ncol(dat2)]))[1]
kmean_setB = which(dat3[86,1:ncol(dat3)]==max(dat3[86,1:ncol(dat3)]))[1]
affinity_setB = which(dat4[86,1:ncol(dat4)]==max(dat4[86,1:ncol(dat4)]))[1]
kmean_setA_com <- merge(cbind(rownames(dat1)[1:85],dat1[1:85,kmean_setA]),dat[,c(1,7)],by.x='V1',by.y='Pathway')
affinity_setA_com <- merge(cbind(rownames(dat2)[1:85],dat2[1:85,affinity_setA]),dat[,c(1,8)],by.x='V1',by.y='Pathway')
kmean_setB_com <- merge(cbind(rownames(dat3)[1:85],dat3[1:85,kmean_setB]),dat[,c(1,10)],by.x='V1',by.y='Pathway')
affinity_setB_com <- merge(cbind(rownames(dat4)[1:85],dat4[1:85,affinity_setB]),dat[,c(1,11)],by.x='V1',by.y='Pathway')
pdf('Clustering_CR.pdf',width=10,height=25)
par(mfrow=c(5,10))
m <- rbind(c(1,2,3,4,5,6,6,6,6,6),c(7,7,7,7,7,8,8,8,8,8),c(9,9,9,9,9,10,10,10,10,10),c(11,11,11,11,11,12,12,12,12,12),c(13,13,13,13,13,14,14,14,14,14))
layout(m)
vioplot(as.numeric(setA[86,]),ylim=c(0,0.6))
abline(h=median(dat$Background_F1_crossvalidation))
abline(h=median(dat$Naive_median_CR),col='orange')
abline(h=median(dat$Naive_max_CR),col='red')
vioplot(as.numeric(setB[86,]),ylim=c(0,0.6))
vioplot(as.numeric(dat$CR_clustering_setA),ylim=c(0,0.6))
vioplot(as.numeric(dat$CR_clustering_setB),ylim=c(0,0.6))
vioplot(dat$Background_F1_crossvalidation,ylim=c(0,0.6))
plot(dat$CR_kmean_setA,dat$CR_Affinity_setA,xlim=c(0,0.6),ylim=c(0,0.6),cex=2)
abline(0,1)
plot(dat$CR_kmean_setB,dat$CR_Affinity_setB,xlim=c(0,0.6),ylim=c(0,0.6),cex=2)
abline(0,1)
plot(dat$CR_clustering_setA,dat$CR_clustering_setB,xlim=c(0,0.6),ylim=c(0,0.6),cex=2)
abline(0,1)
plot(dat$Naive_best_CR,dat$CR_clustering_setB,xlim=c(0,0.6),ylim=c(0,0.6),cex=2)
abline(0,1)
plot(dat$Naive_best_CR,dat$CR_clustering_setA,xlim=c(0,0.6),ylim=c(0,0.6),cex=2)
abline(0,1)
plot(as.numeric(as.character(kmean_setA_com[,2])),as.numeric(kmean_setA_com[,3]),xlim=c(0,0.6),ylim=c(0,0.6),cex=2,xlab='kmean_setA_overall',ylab='kmean_setA_pathway_best')
abline(0,1)
plot(as.numeric(as.character(affinity_setA_com[,2])),as.numeric(affinity_setA_com[,3]),xlim=c(0,0.6),ylim=c(0,0.6),cex=2,xlab='Affinity_setA_overall',ylab='Affinity_setA_pathway_best')
abline(0,1)
plot(as.numeric(as.character(kmean_setB_com[,2])),as.numeric(kmean_setB_com[,3]),xlim=c(0,0.6),ylim=c(0,0.6),cex=2,xlab='kmean_setB_overall',ylab='kmean_setB_pathway_best')
abline(0,1)
plot(as.numeric(as.character(affinity_setB_com[,2])),as.numeric(affinity_setB_com[,3]),xlim=c(0,0.6),ylim=c(0,0.6),cex=2,xlab='Affinity_setB_overall',ylab='Affinity_setB_pathway_best')
abline(0,1)
dev.off()

library('vioplot')
setwd('D:\\Pathway_prediction\\20180831\\Non_overlapping\\Cross_validation')
dat <- read.table('Pathway_best_F1_naive_clustering_ML_CR.txt',head=T,sep='\t',stringsAsFactors=F)
dat1 <- read.table('F1_matrix_pathway_CR_RF_setA.txt',head=T,row.names=1,sep='\t',stringsAsFactors=F)
dat1 <- rbind(dat1,colMeans(dat1))
dat2 <- read.table('F1_matrix_pathway_CR_RF.txt',head=T,row.names=1,sep='\t',stringsAsFactors=F)
dat2 <- rbind(dat2,colMeans(dat2))
RF_setA = which(dat1[86,1:ncol(dat1)]==max(dat1[86,1:ncol(dat1)]))[1]
RF_setB = which(dat2[86,1:ncol(dat2)]==max(dat2[86,1:ncol(dat2)]))[1]
RF_setA_com <- merge(cbind(rownames(dat1)[1:85],dat1[1:85,RF_setA]),dat[,c(1,9)],by.x='V1',by.y='Pathway')
RF_setB_com <- merge(cbind(rownames(dat2)[1:85],dat2[1:85,RF_setB]),dat[,c(1,12)],by.x='V1',by.y='Pathway')
pdf('Random_forest_CR.pdf',width=10,height=15)
par(mfrow=c(2,10))
m <- rbind(c(1,2,3,4,5,6,6,6,6,6),c(7,7,7,7,7,8,8,8,8,8),c(9,9,9,9,9,10,10,10,10,10))
layout(m)
vioplot(as.numeric(dat1[86,]),ylim=c(0,1))
abline(h=median(dat$Background_F1_crossvalidation))
abline(h=median(dat$Naive_median_CR),col='orange')
abline(h=median(dat$Naive_max_CR),col='red')
abline(h=median(dat$CR_clustering_setA),col='green')
abline(h=median(dat$CR_clustering_setB),col='blue')
vioplot(as.numeric(dat2[86,]),ylim=c(0,1))
vioplot(as.numeric(dat$CR_RF_setA),ylim=c(0,1))
vioplot(as.numeric(dat$CR_RF_setB),ylim=c(0,1))
vioplot(dat$Background_F1_crossvalidation,ylim=c(0,1))
plot(dat$CR_RF_setA,dat$CR_RF_setB,xlim=c(0,1),ylim=c(0,1),cex=2)
abline(0,1)
plot(dat$CR_clustering_setB,dat$CR_RF_setB,xlim=c(0,1),ylim=c(0,1),cex=2)
abline(0,1)
plot(dat$Naive_best_CR,dat$CR_RF_setB,xlim=c(0,1),ylim=c(0,1),cex=2)
abline(0,1)
plot(as.numeric(as.character(RF_setA_com[,2])),as.numeric(RF_setA_com[,3]),xlim=c(0,1),ylim=c(0,1),cex=2,xlab='RF_setA_overall',ylab='RF_setA_pathway_best')
abline(0,1)
plot(as.numeric(as.character(RF_setB_com[,2])),as.numeric(RF_setB_com[,3]),xlim=c(0,1),ylim=c(0,1),cex=2,xlab='RF_setB_overall',ylab='RF_setB_pathway_best')
abline(0,1)
dev.off()
